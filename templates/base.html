<!DOCTYPE html>
<html lang="en" data-theme="{{ theme|default('oled-limited') }}">
    <script>
        var r2sd = document.documentElement;
        function openFullscreen() {
            if (r2sd.requestFullscreen) {
                r2sd.requestFullscreen();
            } else if (r2sd.webkitRequestFullscreen) { /* Safari */
                r2sd.webkitRequestFullscreen();
            } else if (r2sd.msRequestFullscreen) { /* IE11 */
                r2sd.msRequestFullscreen();
            }
        }
        /* Close fullscreen */
        function closeFullscreen() {
            if (document.exitFullscreen) {
                document.exitFullscreen();
            } else if (document.webkitExitFullscreen) { /* Safari */
                document.webkitExitFullscreen();
            } else if (document.msExitFullscreen) { /* IE11 */
                document.msExitFullscreen();
            }
        }

        function toggleFullscreen() {
            const isFull =
                document.fullscreenElement ||
                document.webkitFullscreenElement ||
                document.msFullscreenElement;
            if (isFull) {
                closeFullscreen();
            } else {
                openFullscreen();
            }
        }

        // Shutdown functionality disabled - causes issues with terminal/browser windows
        // For service deployments, use proper service management tools instead
        // async function shutdownApp() {
        //     const confirmExit = confirm('Close RomM2SteamDeck and stop the server?');
        //     if (!confirmExit) {
        //         return;
        //     }
        //     try {
        //         await fetch('/shutdown', { method: 'POST' });
        //     } catch (e) {
        //         console.error('Shutdown request failed', e);
        //     }
        //     // Best-effort attempt to close the browser window/tab.
        //     // Some browsers may block this if the window was not opened by script.
        //     window.open('', '_self');
        //     window.close();
        // }
    </script>
<head>
    <meta charset="UTF-8">    
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>{% block title %}RomM2SteamDeck{% endblock title %}</title>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bulma@1.0.2/css/bulma.min.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.7.2/css/all.min.css">   
          
    <style>
        /* Theme definitions */
        :root, [data-theme="oled-limited"] {
            --theme-primary: #FF6B00;
            --theme-primary-hover: #FF8533;
            --theme-primary-glow: rgba(255, 107, 0, 0.5);
            --theme-navbar-bg: #FF6B00;
            --theme-navbar-text: #ffffff;
            --theme-body-bg: #0a0a0a;
            --theme-card-bg: #1a1a2e;
            --theme-text: #ffffff;
            --theme-text-muted: #aaaaaa;
        }
        
        [data-theme="oled-black"] {
            --theme-primary: #1a1a1a;
            --theme-primary-hover: #333333;
            --theme-primary-glow: rgba(50, 50, 50, 0.5);
            --theme-navbar-bg: #000000;
            --theme-navbar-text: #ffffff;
            --theme-body-bg: #000000;
            --theme-card-bg: #111111;
            --theme-text: #ffffff;
            --theme-text-muted: #888888;
        }
        
        [data-theme="classic-white"] {
            --theme-primary: #1a73e8;
            --theme-primary-hover: #4285f4;
            --theme-primary-glow: rgba(26, 115, 232, 0.5);
            --theme-navbar-bg: #ffffff;
            --theme-navbar-text: #333333;
            --theme-body-bg: #f5f5f5;
            --theme-card-bg: #ffffff;
            --theme-text: #333333;
            --theme-text-muted: #666666;
        }
        
        [data-theme="monochrome"] {
            --theme-primary: #333333;
            --theme-primary-hover: #555555;
            --theme-primary-glow: rgba(50, 50, 50, 0.5);
            --theme-navbar-bg: #222222;
            --theme-navbar-text: #ffffff;
            --theme-body-bg: #111111;
            --theme-card-bg: #1a1a1a;
            --theme-text: #ffffff;
            --theme-text-muted: #999999;
        }
        
        [data-theme="steam-blue"] {
            --theme-primary: #1b2838;
            --theme-primary-hover: #2a475e;
            --theme-primary-glow: rgba(102, 192, 244, 0.5);
            --theme-navbar-bg: #171a21;
            --theme-navbar-text: #c7d5e0;
            --theme-body-bg: #1b2838;
            --theme-card-bg: #2a475e;
            --theme-text: #c7d5e0;
            --theme-text-muted: #8b929a;
        }
        
        [data-theme="purple-haze"] {
            --theme-primary: #7b2cbf;
            --theme-primary-hover: #9d4edd;
            --theme-primary-glow: rgba(157, 78, 221, 0.5);
            --theme-navbar-bg: #5a189a;
            --theme-navbar-text: #ffffff;
            --theme-body-bg: #10002b;
            --theme-card-bg: #240046;
            --theme-text: #ffffff;
            --theme-text-muted: #c77dff;
        }
        
        [data-theme="matrix-green"] {
            --theme-primary: #00ff41;
            --theme-primary-hover: #00cc33;
            --theme-primary-glow: rgba(0, 255, 65, 0.5);
            --theme-navbar-bg: #001a00;
            --theme-navbar-text: #00ff41;
            --theme-body-bg: #000d00;
            --theme-card-bg: #001a00;
            --theme-text: #00ff41;
            --theme-text-muted: #008f11;
        }
        
        [data-theme="crimson-red"] {
            --theme-primary: #dc2626;
            --theme-primary-hover: #ef4444;
            --theme-primary-glow: rgba(220, 38, 38, 0.5);
            --theme-navbar-bg: #7f1d1d;
            --theme-navbar-text: #ffffff;
            --theme-body-bg: #1c1917;
            --theme-card-bg: #292524;
            --theme-text: #ffffff;
            --theme-text-muted: #a8a29e;
        }
        
        [data-theme="ocean-teal"] {
            --theme-primary: #0d9488;
            --theme-primary-hover: #14b8a6;
            --theme-primary-glow: rgba(13, 148, 136, 0.5);
            --theme-navbar-bg: #134e4a;
            --theme-navbar-text: #ffffff;
            --theme-body-bg: #042f2e;
            --theme-card-bg: #115e59;
            --theme-text: #ffffff;
            --theme-text-muted: #5eead4;
        }
        
        [data-theme="sunset-gold"] {
            --theme-primary: #f59e0b;
            --theme-primary-hover: #fbbf24;
            --theme-primary-glow: rgba(245, 158, 11, 0.5);
            --theme-navbar-bg: #78350f;
            --theme-navbar-text: #ffffff;
            --theme-body-bg: #1c1917;
            --theme-card-bg: #292524;
            --theme-text: #ffffff;
            --theme-text-muted: #d6d3d1;
        }
        
        /* Apply theme variables */
        body {
            background-color: var(--theme-body-bg) !important;
            color: var(--theme-text) !important;
        }
        
        .button.is-primary {
            background-color: var(--theme-primary) !important;
            border-color: transparent !important;
            color: var(--theme-navbar-text) !important;
        }
        .button.is-primary:hover {
            background-color: var(--theme-primary-hover) !important;
        }
        
        .button.is-info {
            background-color: var(--theme-primary) !important;
            color: var(--theme-navbar-text) !important;
        }
        
        .tag.is-info {
            background-color: var(--theme-primary) !important;
            color: var(--theme-navbar-text) !important;
        }
        
        .select select:focus, .input:focus {
            border-color: var(--theme-primary) !important;
            box-shadow: 0 0 0 0.125em var(--theme-primary-glow) !important;
        }
        
        .navbar {
            background-color: var(--theme-navbar-bg) !important;
            border-bottom: none;
            position: sticky;
            top: 0;
            z-index: 1000;
        }
        
        .navbar-menu {
            background-color: var(--theme-navbar-bg) !important;
        }
        
        .navbar-brand {
            background-color: var(--theme-navbar-bg) !important;
            flex-grow: 1;
            width: 100%;
            min-height: 3.25rem;
        }
        
        /* Settings gear - pushed to far right */
        .settings-gear {
            margin-left: auto !important;
            margin-right: 1rem !important;
        }
        
        @media screen and (max-width: 768px) {
            #navbar-platform-container .select select {
                min-width: 140px;
                font-size: 0.85rem;
            }
            .settings-gear {
                margin-right: 0.5rem !important;
            }
        }
        
        .navbar-item {
            color: var(--theme-navbar-text) !important;
            background-color: transparent !important;
        }
        .navbar-item:hover {
            background-color: rgba(0, 0, 0, 0.2) !important;
            color: var(--theme-navbar-text) !important;
        }
        
        /* Light theme adjustments */
        [data-theme="classic-white"] .navbar-item:hover {
            background-color: rgba(0, 0, 0, 0.1) !important;
        }
        [data-theme="classic-white"] .card,
        [data-theme="classic-white"] .has-background-dark {
            background-color: var(--theme-card-bg) !important;
            color: var(--theme-text) !important;
        }
        [data-theme="classic-white"] .label,
        [data-theme="classic-white"] .title,
        [data-theme="classic-white"] .card-header-title {
            color: var(--theme-text) !important;
        }
        
        #navbar-platform-container .select select {
            background-color: rgba(0, 0, 0, 0.3);
            color: var(--theme-navbar-text);
            border-color: rgba(255, 255, 255, 0.5);
            min-width: 200px;
        }
        #navbar-platform-container .select select:hover {
            border-color: var(--theme-navbar-text);
        }
        #navbar-platform-container .select:not(.is-multiple):not(.is-loading)::after {
            border-color: var(--theme-navbar-text);
        }
        
        /* Card backgrounds */
        .has-background-dark {
            background-color: var(--theme-card-bg) !important;
        }
        
        .list{--be-list-color:var(--bulma-text);--be-list-item-description-color:var(--bulma-text-50);--be-list-item-divider-color:var(--bulma-border);--be-list-item-hover-color:var(--bulma-scheme-main-bis);--be-list-item-image-margin:.75em;--be-list-item-padding:.75em;--be-list-item-title-color:var(--bulma-text-strong);--be-list-item-title-weight:var(--bulma-weight-semibold);color:var(--be-list-color);flex-direction:column;display:flex}.list.has-hidden-images .list-item-image{display:none}.list.has-hoverable-list-items .list-item:hover{background-color:var(--be-list-item-hover-color)}.list.has-overflow-ellipsis .list-item-content{min-inline-size:0;max-inline-size:calc(var(--length)*1ch)}.list.has-overflow-ellipsis .list-item-content>*{text-overflow:ellipsis;white-space:nowrap;overflow:hidden}@media (hover:hover){.list:not(.has-visible-pointer-controls) .list-item-controls{opacity:0;visibility:hidden}}.list .list-item{align-items:center;transition:background-color .125s ease-out;display:flex;position:relative}@media (hover:hover){.list .list-item:hover .list-item-controls,.list .list-item:focus-within .list-item-controls{opacity:initial;visibility:initial}}.list .list-item:not(.box){padding-block:var(--be-list-item-padding);padding-inline:var(--be-list-item-padding)}.list .list-item:not(:last-child):not(.box){border-block-end:1px solid var(--be-list-item-divider-color)}@media screen and (width<=768px){.list:not(.has-overflow-ellipsis) .list .list-item{flex-wrap:wrap}}.list .list-item-image{flex-shrink:0;margin-inline-end:var(--be-list-item-image-margin)}@media screen and (width<=768px){.list .list-item-image{padding-block:.5rem;padding-inline:0}}.list .list-item-content{flex-direction:column;flex-grow:1;display:flex}@media screen and (width<=768px){.list .list-item-content{padding-block:.5rem;padding-inline:0}}.list .list-item-title{color:var(--be-list-item-title-color);font-weight:var(--be-list-item-title-weight)}.list .list-item-description{color:var(--be-list-item-description-color)}.list .list-item-controls{flex-shrink:0;transition:opacity .125s ease-out}@media screen and (width<=768px){.list .list-item-controls{flex-wrap:wrap;padding-block:.5rem;padding-inline:0}}@media screen and (width>=769px),print{.list .list-item-controls{padding-inline-start:var(--be-list-item-padding)}.list:not(.has-visible-pointer-controls) .list .list-item-controls{block-size:100%;align-items:center;padding-block-end:var(--be-list-item-padding);display:flex;position:absolute;inset-inline-end:0}}
/*# sourceMappingURL=bulma-list.css.map */  

        .icon-in-progess {
            color: #FFB70F;
        }
        .icon-in-success {
            color: #48C78E;
        }
        .icon-in-error {
            color: #FF6685;
        }

        .checkbox {
            margin-right: 10px;
            transform: scale(1.2);
        }

        .custom-title {
            padding-top: 20px !important;
        }

        .cell {
            padding-top: 15px !important;
        }

        .input-field {
            length: 100%;
        }
        
        .btn-bars-menu {
            margin-left: 15px;
        }

        .collapse-icon {
            padding-top: 20px;
        }

        .collapse {
            display: none;
        }

        /* Toast notification system */
        .toast-container {
            position: fixed;
            top: 4.5rem;
            right: 1rem;
            z-index: 9999;
            display: flex;
            flex-direction: column;
            gap: 0.5rem;
            pointer-events: none;
        }

        .toast {
            padding: 0.75rem 1rem;
            border-radius: 6px;
            background: var(--theme-card-bg, #1a1a2e);
            color: var(--theme-text, #fff);
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.4);
            display: flex;
            align-items: center;
            gap: 0.5rem;
            animation: toastSlideIn 0.3s ease-out;
            max-width: 320px;
            pointer-events: auto;
        }

        .toast.is-success { border-left: 4px solid #48c78e; }
        .toast.is-warning { border-left: 4px solid #ffe08a; }
        .toast.is-danger { border-left: 4px solid #f14668; }
        .toast.is-info { border-left: 4px solid var(--theme-primary); }

        @keyframes toastSlideIn {
            from { transform: translateX(100%); opacity: 0; }
            to { transform: translateX(0); opacity: 1; }
        }

        /* Theme drawer */
        .theme-drawer {
            position: fixed;
            top: 0;
            right: -320px;
            width: 320px;
            height: 100vh;
            background: var(--theme-card-bg, #1a1a2e);
            box-shadow: -4px 0 20px rgba(0, 0, 0, 0.5);
            z-index: 1001;
            transition: right 0.3s ease;
            display: flex;
            flex-direction: column;
        }

        .theme-drawer.is-open {
            right: 0;
        }

        .theme-drawer-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.5);
            z-index: 1000;
            opacity: 0;
            visibility: hidden;
            transition: opacity 0.3s ease;
        }

        .theme-drawer-overlay.is-open {
            opacity: 1;
            visibility: visible;
        }

        .theme-drawer-header {
            padding: 1rem;
            border-bottom: 1px solid rgba(255,255,255,0.1);
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .theme-drawer-content {
            padding: 1rem;
            overflow-y: auto;
            flex: 1;
        }

        .theme-drawer .theme-grid {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 0.75rem;
        }

        .theme-option {
            position: relative;
            cursor: pointer;
            border-radius: 8px;
            overflow: hidden;
            transition: transform 0.2s, box-shadow 0.2s;
        }

        .theme-option:hover {
            transform: translateY(-2px);
        }

        .theme-option.selected {
            box-shadow: 0 0 0 3px var(--theme-primary);
        }

        .theme-preview {
            height: 60px;
            display: flex;
            flex-direction: column;
        }

        .theme-preview-navbar {
            height: 20px;
            display: flex;
            align-items: center;
            padding: 0 6px;
        }

        .theme-preview-navbar span {
            font-size: 8px;
            font-weight: bold;
        }

        .theme-preview-body {
            flex: 1;
            padding: 6px;
            display: flex;
            gap: 3px;
        }

        .theme-preview-card {
            width: 16px;
            height: 100%;
            border-radius: 2px;
        }

        .theme-label {
            padding: 0.4rem;
            text-align: center;
            font-size: 0.75rem;
            font-weight: 500;
            background: rgba(0,0,0,0.3);
            color: #fff;
        }

        .theme-check {
            position: absolute;
            top: 4px;
            right: 4px;
            background: var(--theme-primary);
            color: white;
            border-radius: 50%;
            width: 18px;
            height: 18px;
            display: none;
            align-items: center;
            justify-content: center;
            font-size: 9px;
        }

        .theme-option.selected .theme-check {
            display: flex;
        }

    </style>
</head>
<body>        
    <!-- Navigation Bar -->
    
    <nav class="navbar" role="navigation" aria-label="main navigation">
        <div class="navbar-brand">
            <a class="navbar-item" href="/">
                <strong>RomM2SteamDeck</strong>
            </a>
            
            <!-- Platform dropdown - always visible -->
            <div class="navbar-item" id="navbar-platform-container">
                <!-- Platform dropdown will be injected here by JavaScript -->
            </div>
            
            <!-- Settings gear - always visible, pushed to right -->
            <a class="navbar-item settings-gear" href="/settings" title="Settings">
                <span class="icon is-medium"><i class="fa-solid fa-gear fa-lg"></i></span>
            </a>

            <!-- Theme selector -->
            <a class="navbar-item" href="javascript:void(0)" onclick="toggleThemeDrawer()" title="Theme">
                <span class="icon is-medium"><i class="fa-solid fa-palette fa-lg"></i></span>
            </a>

            <!-- Fullscreen toggle -->
            <a class="navbar-item" href="javascript:void(0)" onclick="toggleFullscreen()" title="Toggle fullscreen">
                <span class="icon is-medium"><i class="fa-solid fa-expand fa-lg"></i></span>
            </a>

            <!-- Exit application button disabled - use service management tools instead -->
            <!-- <a class="navbar-item" href="javascript:void(0)" onclick="shutdownApp()" title="Exit application">
                <span class="icon is-medium"><i class="fa-solid fa-power-off fa-lg"></i></span>
            </a> -->

        </div>
    </nav>

    <!-- Toast notifications container -->
    <div id="toast-container" class="toast-container"></div>

    <!-- Theme drawer -->
    <div id="theme-drawer" class="theme-drawer">
        <div class="theme-drawer-header">
            <span class="title is-5" style="color: var(--theme-text);">Theme</span>
            <button class="delete" onclick="toggleThemeDrawer()"></button>
        </div>
        <div class="theme-drawer-content">
            <div class="theme-grid">
                <div class="theme-option {{ 'selected' if theme == 'oled-limited' else '' }}" data-theme="oled-limited" onclick="selectTheme('oled-limited')">
                    <div class="theme-preview">
                        <div class="theme-preview-navbar" style="background: #FF6B00;"><span style="color: #fff;">R2SD</span></div>
                        <div class="theme-preview-body" style="background: #0a0a0a;">
                            <div class="theme-preview-card" style="background: #1a1a2e;"></div>
                            <div class="theme-preview-card" style="background: #1a1a2e;"></div>
                        </div>
                    </div>
                    <div class="theme-label">OLED Limited</div>
                    <span class="theme-check"><i class="fa-solid fa-check"></i></span>
                </div>
                <div class="theme-option {{ 'selected' if theme == 'oled-black' else '' }}" data-theme="oled-black" onclick="selectTheme('oled-black')">
                    <div class="theme-preview">
                        <div class="theme-preview-navbar" style="background: #000000;"><span style="color: #fff;">R2SD</span></div>
                        <div class="theme-preview-body" style="background: #000000;">
                            <div class="theme-preview-card" style="background: #111111;"></div>
                            <div class="theme-preview-card" style="background: #111111;"></div>
                        </div>
                    </div>
                    <div class="theme-label">OLED Black</div>
                    <span class="theme-check"><i class="fa-solid fa-check"></i></span>
                </div>
                <div class="theme-option {{ 'selected' if theme == 'classic-white' else '' }}" data-theme="classic-white" onclick="selectTheme('classic-white')">
                    <div class="theme-preview">
                        <div class="theme-preview-navbar" style="background: #ffffff;"><span style="color: #333;">R2SD</span></div>
                        <div class="theme-preview-body" style="background: #f5f5f5;">
                            <div class="theme-preview-card" style="background: #ffffff;"></div>
                            <div class="theme-preview-card" style="background: #ffffff;"></div>
                        </div>
                    </div>
                    <div class="theme-label">Classic White</div>
                    <span class="theme-check"><i class="fa-solid fa-check"></i></span>
                </div>
                <div class="theme-option {{ 'selected' if theme == 'monochrome' else '' }}" data-theme="monochrome" onclick="selectTheme('monochrome')">
                    <div class="theme-preview">
                        <div class="theme-preview-navbar" style="background: #222222;"><span style="color: #fff;">R2SD</span></div>
                        <div class="theme-preview-body" style="background: #111111;">
                            <div class="theme-preview-card" style="background: #1a1a1a;"></div>
                            <div class="theme-preview-card" style="background: #1a1a1a;"></div>
                        </div>
                    </div>
                    <div class="theme-label">Monochrome</div>
                    <span class="theme-check"><i class="fa-solid fa-check"></i></span>
                </div>
                <div class="theme-option {{ 'selected' if theme == 'steam-blue' else '' }}" data-theme="steam-blue" onclick="selectTheme('steam-blue')">
                    <div class="theme-preview">
                        <div class="theme-preview-navbar" style="background: #171a21;"><span style="color: #c7d5e0;">R2SD</span></div>
                        <div class="theme-preview-body" style="background: #1b2838;">
                            <div class="theme-preview-card" style="background: #2a475e;"></div>
                            <div class="theme-preview-card" style="background: #2a475e;"></div>
                        </div>
                    </div>
                    <div class="theme-label">Steam Blue</div>
                    <span class="theme-check"><i class="fa-solid fa-check"></i></span>
                </div>
                <div class="theme-option {{ 'selected' if theme == 'purple-haze' else '' }}" data-theme="purple-haze" onclick="selectTheme('purple-haze')">
                    <div class="theme-preview">
                        <div class="theme-preview-navbar" style="background: #5a189a;"><span style="color: #fff;">R2SD</span></div>
                        <div class="theme-preview-body" style="background: #10002b;">
                            <div class="theme-preview-card" style="background: #240046;"></div>
                            <div class="theme-preview-card" style="background: #240046;"></div>
                        </div>
                    </div>
                    <div class="theme-label">Purple Haze</div>
                    <span class="theme-check"><i class="fa-solid fa-check"></i></span>
                </div>
                <div class="theme-option {{ 'selected' if theme == 'matrix-green' else '' }}" data-theme="matrix-green" onclick="selectTheme('matrix-green')">
                    <div class="theme-preview">
                        <div class="theme-preview-navbar" style="background: #001a00;"><span style="color: #00ff41;">R2SD</span></div>
                        <div class="theme-preview-body" style="background: #000d00;">
                            <div class="theme-preview-card" style="background: #001a00;"></div>
                            <div class="theme-preview-card" style="background: #001a00;"></div>
                        </div>
                    </div>
                    <div class="theme-label">Matrix Green</div>
                    <span class="theme-check"><i class="fa-solid fa-check"></i></span>
                </div>
                <div class="theme-option {{ 'selected' if theme == 'crimson-red' else '' }}" data-theme="crimson-red" onclick="selectTheme('crimson-red')">
                    <div class="theme-preview">
                        <div class="theme-preview-navbar" style="background: #7f1d1d;"><span style="color: #fff;">R2SD</span></div>
                        <div class="theme-preview-body" style="background: #1c1917;">
                            <div class="theme-preview-card" style="background: #292524;"></div>
                            <div class="theme-preview-card" style="background: #292524;"></div>
                        </div>
                    </div>
                    <div class="theme-label">Crimson Red</div>
                    <span class="theme-check"><i class="fa-solid fa-check"></i></span>
                </div>
                <div class="theme-option {{ 'selected' if theme == 'ocean-teal' else '' }}" data-theme="ocean-teal" onclick="selectTheme('ocean-teal')">
                    <div class="theme-preview">
                        <div class="theme-preview-navbar" style="background: #134e4a;"><span style="color: #fff;">R2SD</span></div>
                        <div class="theme-preview-body" style="background: #042f2e;">
                            <div class="theme-preview-card" style="background: #115e59;"></div>
                            <div class="theme-preview-card" style="background: #115e59;"></div>
                        </div>
                    </div>
                    <div class="theme-label">Ocean Teal</div>
                    <span class="theme-check"><i class="fa-solid fa-check"></i></span>
                </div>
                <div class="theme-option {{ 'selected' if theme == 'sunset-gold' else '' }}" data-theme="sunset-gold" onclick="selectTheme('sunset-gold')">
                    <div class="theme-preview">
                        <div class="theme-preview-navbar" style="background: #78350f;"><span style="color: #fff;">R2SD</span></div>
                        <div class="theme-preview-body" style="background: #1c1917;">
                            <div class="theme-preview-card" style="background: #292524;"></div>
                            <div class="theme-preview-card" style="background: #292524;"></div>
                        </div>
                    </div>
                    <div class="theme-label">Sunset Gold</div>
                    <span class="theme-check"><i class="fa-solid fa-check"></i></span>
                </div>
            </div>
        </div>
    </div>
    <div id="theme-drawer-overlay" class="theme-drawer-overlay" onclick="toggleThemeDrawer()"></div>

    <!-- Main Content -->
    <section class="section" style="padding: 1rem;">
        <!-- <div class="container"> -->
            {% block content %}
            {% endblock content %}
        <!-- </div> -->
    </section>

    <script>
        // Toast notification system
        function showToast(message, type = 'info', duration = 4000) {
            let container = document.getElementById('toast-container');
            if (!container) {
                container = document.createElement('div');
                container.id = 'toast-container';
                container.className = 'toast-container';
                document.body.appendChild(container);
            }

            const icons = {
                success: 'fa-check-circle',
                warning: 'fa-exclamation-triangle',
                danger: 'fa-times-circle',
                info: 'fa-info-circle'
            };

            const toast = document.createElement('div');
            toast.className = `toast is-${type}`;
            toast.innerHTML = `
                <span class="icon"><i class="fa-solid ${icons[type] || icons.info}"></i></span>
                <span>${message}</span>
            `;

            container.appendChild(toast);

            if (duration > 0) {
                setTimeout(() => {
                    toast.style.animation = 'toastSlideIn 0.3s ease-out reverse';
                    setTimeout(() => toast.remove(), 300);
                }, duration);
            }
        }

        // Theme drawer functions
        function toggleThemeDrawer() {
            document.getElementById('theme-drawer').classList.toggle('is-open');
            document.getElementById('theme-drawer-overlay').classList.toggle('is-open');
        }

        function selectTheme(themeId) {
            // Update UI
            document.querySelectorAll('.theme-option').forEach(opt => {
                opt.classList.toggle('selected', opt.dataset.theme === themeId);
            });

            // Apply theme immediately
            document.documentElement.setAttribute('data-theme', themeId);

            // Save to server
            fetch('/settings/theme', {
                method: 'POST',
                headers: { 'Content-Type': 'application/x-www-form-urlencoded' },
                body: 'theme=' + themeId
            }).then(() => {
                showToast('Theme updated', 'success', 2000);
            }).catch(() => {
                showToast('Failed to save theme', 'danger');
            });
        }

        // Close drawer on Escape key
        document.addEventListener('keydown', (e) => {
            if (e.key === 'Escape') {
                const themeDrawer = document.getElementById('theme-drawer');
                const themeOverlay = document.getElementById('theme-drawer-overlay');
                if (themeDrawer) themeDrawer.classList.remove('is-open');
                if (themeOverlay) themeOverlay.classList.remove('is-open');

                const queueDrawer = document.getElementById('queue-drawer');
                const queueOverlay = document.getElementById('queue-drawer-overlay');
                if (queueDrawer) queueDrawer.classList.remove('is-open');
                if (queueOverlay) queueOverlay.classList.remove('is-open');
            }
        });

    </script>
</body>
</html>
